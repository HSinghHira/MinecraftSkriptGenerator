<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Minecraft Skript Generator</title>
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22256%22 height=%22256%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 rx=%2250%22 fill=%22%23e9e9e9%22></rect><text x=%2250%%22 y=%2250%%22 dominant-baseline=%22central%22 text-anchor=%22middle%22 font-size=%2277%22>üíé</text></svg>" />

    <style>
        :root {
            --bg-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-bg: #fff;
            --text: #222;
            --muted: #666;
            --accent: #667eea;
            --success: #2e7d32;
        }

        [data-theme="dark"] {
            --card-bg: #1a202c;
            --text: #f7fafc;
            --muted: #a0aec0;
            --bg-1: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
        }

        * {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
        }

        body {
            margin: 0;
            font-family: Inter, 'Segoe UI', Roboto, system-ui, -apple-system, 'Helvetica Neue', Arial;
            background: var(--bg-1);
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding: 28px;
            color: var(--text);
        }

        .container {
            width: 100%;
            max-width: 1200px;
            background: var(--card-bg);
            border-radius: 14px;
            padding: 28px;
            box-shadow: 0 20px 60px rgba(2, 6, 23, .35);
            transition: all .22s;
        }

        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        h1 {
            font-size: 22px;
            margin: 0;
        }

        .meta {
            color: var(--muted);
            font-size: 13px;
        }

        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .btn {
            background: transparent;
            border: 1px solid rgba(0, 0, 0, .06);
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            color: var(--text);
            transition: all 0.2s;
        }

        .btn:hover {
            transform: scale(1.03);
            background: rgba(0, 0, 0, 0.04);
        }

        .btn.primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
            border: 0;
        }

        .btn.primary:hover {
            opacity: 0.9;
        }

        [data-theme="dark"] .btn {
            border-color: #4a5568;
        }

        [data-theme="dark"] .btn:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 500px;
            gap: 20px;
            margin-top: 18px;
        }

        .card {
            background: rgba(255, 255, 255, 0.04);
            padding: 16px;
            border-radius: 10px;
        }

        [data-theme="dark"] .card {
            background: rgba(255, 255, 255, 0.05);
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
        }

        input[type=text],
        input[type=number],
        textarea,
        select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #e6e9ef;
            background: rgba(0, 0, 0, 0.02);
            color: var(--text);
        }

        [data-theme="dark"] input[type=text],
        [data-theme="dark"] input[type=number],
        [data-theme="dark"] textarea,
        [data-theme="dark"] select {
            border-color: #4a5568;
            background: rgba(255, 255, 255, 0.05);
        }

        textarea {
            min-height: 150px;
            font-family: monospace;
        }

        .row {
            display: flex;
            gap: 10px;
        }

        .small {
            font-size: 12px;
            color: var(--muted);
        }

        .actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .hidden {
            display: none;
        }

        @media (max-width:980px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }

        .badge {
            background: #eef2ff;
            color: #334155;
            padding: 6px 8px;
            border-radius: 999px;
            font-weight: 600;
            font-size: 12px;
        }

        .drop-area {
            border: 2px dashed rgba(0, 0, 0, .06);
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            color: var(--muted);
            cursor: pointer;
            margin-bottom: 10px;
        }

        [data-theme="dark"] .drop-area {
            border-color: #4a5568;
        }

        #alertContainer {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 350px;
        }

        .alert {
            padding: 12px 16px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            animation: slideInRight 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .alert .close-alert {
            margin-left: auto;
            cursor: pointer;
            font-weight: bold;
            opacity: 0.7;
            font-size: 18px;
        }

        .alert .close-alert:hover {
            opacity: 1;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Toggle Switch Styles */
        .toggle-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.3s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        input:checked+.toggle-slider {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        input:checked+.toggle-slider:before {
            transform: translateX(20px);
        }

        [data-theme="dark"] .toggle-slider {
            background-color: #4a5568;
        }

        .section-divider {
            margin: 5px 0;
            border: 0;
            height: 1px;
            background: linear-gradient(90deg, #0000, #0002, #0000);
        }

        .option-group {
            margin-bottom: 12px;
        }

        .input-group {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-top: 6px;
        }

        .input-small {
            width: 80px;
        }

        .tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 12px;
            border-bottom: 2px solid rgba(0, 0, 0, 0.06);
        }

        .tab {
            padding: 8px 16px;
            background: transparent;
            border: none;
            cursor: pointer;
            color: var(--muted);
            font-weight: 500;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
            transition: all 0.2s;
        }

        .tab.active {
            color: var(--accent);
            border-bottom-color: var(--accent);
        }

        .tab:hover {
            color: var(--text);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>

<body>
    <div class="container" id="app">
        <div id="alertContainer"></div>

        <header>
            <div>
                <h1>‚öîÔ∏è Minecraft Skript Generator</h1>
                <div class="meta">Advanced Skript generator with professional features</div>
            </div>
            <div class="controls">
                <button class="btn" id="themeToggle">üåô Theme</button>
            </div>
        </header>

        <div class="grid">
            <!-- Left -->
            <div>
                <div class="card">
                    <label for="commandName">Command Name</label>
                    <input id="commandName" type="text" placeholder="e.g., warrior, kit1" />

                    <div class="option-group" style="margin-top:12px">
                        <label for="aliases" style="margin-bottom:4px">Aliases (comma-separated)</label>
                        <input id="aliases" type="text" placeholder="e.g., w, war" />
                        <div class="small" style="margin-top:4px">Alternative names for the command</div>
                    </div>

                    <label for="inputCommands">Paste your Minecraft commands</label>
                    <div class="drop-area" id="dropArea">Drag &amp; drop a <code>.txt</code> or <code>.mcfunction</code>
                        file here, or paste below.</div>
                    <textarea id="inputCommands"
                        placeholder="summon item ~ ~1 ~ {Item:{id:iron_helmet,...}}"></textarea>

                    <div class="row" style="margin-top:10px;align-items:center">
                        <div class="small">Lines parsed: <span id="linesCount">0</span></div>
                        <div style="flex:1"></div>
                        <div class="small">Chars: <span id="charCount">0</span></div>
                    </div>

                    <div class="actions">
                        <button class="btn primary" id="generateBtn">üî® Generate</button>
                        <button class="btn" id="copyBtn">üìã Copy</button>
                        <button class="btn" id="saveBtn">üíæ Save .sk</button>
                        <button class="btn" id="zipBtn">üóúÔ∏è Save ZIP</button>
                    </div>
                </div>

                <div class="card" style="margin-top:12px">
                    <div class="tabs">
                        <button class="tab active" data-tab="basic">Basic</button>
                        <button class="tab" data-tab="execution">Execution</button>
                        <button class="tab" data-tab="messages">Messages</button>
                        <button class="tab" data-tab="advanced">Advanced</button>
                    </div>

                    <!-- Basic Tab -->
                    <div class="tab-content active" data-content="basic">
                        <div class="row">
                            <div class="toggle-wrapper" style="flex:1">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="includePerm" checked />
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Include permission</span>
                            </div>
                            <div class="toggle-wrapper" style="flex:1">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="consoleExec" checked />
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Console execute</span>
                            </div>
                        </div>

                        <div class="option-group" style="margin-top:12px">
                            <label>Cooldown (seconds)</label>
                            <input id="cooldown" type="number" min="0" value="0" class="input-small" placeholder="0">
                        </div>
                    </div>

                    <!-- Execution Tab -->
                    <div class="tab-content" data-content="execution">
                        <div class="option-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="addDelay" />
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Add delay between commands</span>
                            </div>
                            <div class="input-group" style="margin-left:54px">
                                <input id="delayTime" type="number" min="0" step="0.1" value="0.5" class="input-small"
                                    placeholder="0.5">
                                <span class="small">seconds</span>
                            </div>
                        </div>

                        <div class="option-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="loopCommands" />
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Loop/Repeat commands</span>
                            </div>
                            <div class="input-group" style="margin-left:54px">
                                <input id="loopCount" type="number" min="1" value="2" class="input-small"
                                    placeholder="2">
                                <span class="small">times</span>
                            </div>
                        </div>

                        <div class="option-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="replaceCoords" />
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Replace ~ ~ ~ with player location</span>
                            </div>
                        </div>
                    </div>

                    <!-- Messages Tab -->
                    <div class="tab-content" data-content="messages">
                        <div class="option-group">
                            <label>Success message</label>
                            <input id="successMsg" type="text" value="&aAll items spawned!">
                        </div>

                        <div class="option-group">
                            <label>Message type</label>
                            <select id="messageType">
                                <option value="send">Chat message (send)</option>
                                <option value="actionbar">Action bar</option>
                                <option value="title">Title</option>
                            </select>
                        </div>

                        <div class="option-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="playSound" />
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Play success sound</span>
                            </div>
                            <input id="soundName" type="text" placeholder="entity.player.levelup"
                                style="margin-top:8px;margin-left:54px">
                        </div>

                        <div class="option-group">
                            <label>Error message (no permission)</label>
                            <input id="errorMsg" type="text" value="&cYou don't have permission!">
                        </div>
                    </div>

                    <!-- Advanced Tab -->
                    <div class="tab-content" data-content="advanced">
                        <div class="option-group">
                            <label>Indentation</label>
                            <select id="indentType">
                                <option value="spaces">Spaces (4)</option>
                                <option value="tabs">Tabs</option>
                            </select>
                        </div>

                        <div class="option-group">
                            <label>Comment style</label>
                            <select id="commentStyle">
                                <option value="descriptive">Descriptive</option>
                                <option value="minimal">Minimal</option>
                                <option value="none">None</option>
                            </select>
                        </div>

                        <div class="option-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="addHeader" checked />
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Add file header comment</span>
                            </div>
                        </div>

                        <div class="option-group">
                            <div class="toggle-wrapper">
                                <label class="toggle-switch">
                                    <input id="autoUpdate" type="checkbox" checked />
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Auto-update preview</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right -->
            <div>
                <div class="card">
                    <div style="display:flex;align-items:center;justify-content:space-between">
                        <label>Generated Skript</label>
                        <div class="badge" id="previewBadge">Preview</div>
                    </div>

                    <textarea id="outputSkript" readonly
                        style="margin-top:12px;height:520px;width:100%;padding:12px;background:#0b1220;color:#cfe8ff;border:1px solid #1e293b;border-radius:8px;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:13px;line-height:1.5;resize:none;"></textarea>

                    <div style="margin-top:10px;display:none;gap:8px;align-items:center">
                        <div style="flex:1"></div>
                        <div class="small" id="genStatus"></div>
                    </div>
                </div>

                <div class="card" style="margin-top:12px">
                    <label>Quick Templates</label>
                    <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap">
                        <button class="btn" data-tpl="armor">Armor Set</button>
                        <button class="btn" data-tpl="weapons">Weapons Kit</button>
                        <button class="btn" data-tpl="items">Items Bundle</button>
                        <button class="btn" data-tpl="effects">Effect Kit</button>
                    </div>
                    <div class="small" style="margin-top:8px">Click a template to inject example commands</div>
                </div>
            </div>
        </div>

        <input id="importFile" type="file" class="hidden" accept=".txt,.mcfunction" />
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.0/jszip.min.js" defer></script>

    <script>
        const $ = id => document.getElementById(id);

        function showAlert(message, type = 'success') {
            const icons = { success: '‚úÖ', error: '‚ùå', info: '‚ÑπÔ∏è' };
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.innerHTML = `
        <span>${icons[type] || ''}</span>
        <span>${message}</span>
        <span class="close-alert" onclick="this.parentElement.remove()">√ó</span>
      `;
            $('alertContainer').appendChild(alertDiv);
            setTimeout(() => alertDiv.remove(), 5000);
        }

        // Theme toggle
        const root = document.documentElement;
        const savedTheme = localStorage.getItem('theme') || 'light';
        if (savedTheme === 'dark') root.setAttribute('data-theme', 'dark');

        $('themeToggle').addEventListener('click', () => {
            const isDark = root.getAttribute('data-theme') === 'dark';
            if (isDark) root.removeAttribute('data-theme');
            else root.setAttribute('data-theme', 'dark');
            localStorage.setItem('theme', isDark ? 'light' : 'dark');
            showAlert(`Switched to ${isDark ? 'light' : 'dark'} mode`, 'info');
        });

        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.getAttribute('data-tab');
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                document.querySelector(`[data-content="${tabName}"]`).classList.add('active');
            });
        });

        // Elements
        const inputCommands = $('inputCommands');
        const commandName = $('commandName');
        const outputSkript = $('outputSkript');
        const linesCount = $('linesCount');
        const charCount = $('charCount');
        const includePerm = $('includePerm');
        const consoleExec = $('consoleExec');
        const successMsg = $('successMsg');
        const autoUpdate = $('autoUpdate');
        const aliases = $('aliases');
        const cooldown = $('cooldown');
        const addDelay = $('addDelay');
        const delayTime = $('delayTime');
        const loopCommands = $('loopCommands');
        const loopCount = $('loopCount');
        const replaceCoords = $('replaceCoords');
        const messageType = $('messageType');
        const playSound = $('playSound');
        const soundName = $('soundName');
        const errorMsg = $('errorMsg');
        const indentType = $('indentType');
        const commentStyle = $('commentStyle');
        const addHeader = $('addHeader');

        // Update counters
        function updateCounts() {
            const lines = inputCommands.value.split('\n').filter(l => l.trim());
            linesCount.textContent = lines.length;
            charCount.textContent = inputCommands.value.length;
        }

        // Generate Skript with advanced features
        function generateSkriptString() {
            const name = commandName.value.trim() || 'mycommand';
            const lines = inputCommands.value.split('\n').map(l => l.trim()).filter(l => l);
            if (lines.length === 0) return '';

            const indent = indentType.value === 'tabs' ? '\t' : '    ';
            const commentEnabled = commentStyle.value !== 'none';
            const descriptive = commentStyle.value === 'descriptive';

            let out = '';

            // Header comment
            if (addHeader.checked) {
                out += `# Generated by Minecraft Skript Generator\n`;
                out += `# Generated at: http://go.HSinghHira.me/MSG\n`;
                out += `# Command: /${name}\n`;
                out += `# Date: ${new Date().toLocaleDateString()}\n\n`;
            }

            // Command definition
            out += `command /${name}`;

            // Aliases
            if (aliases.value.trim()) {
                const aliasList = aliases.value.split(',').map(a => a.trim()).filter(a => a);
                if (aliasList.length > 0) {
                    out += ` <alias:/${aliasList.join('/, /')}>`;
                }
            }
            out += `:\n`;

            // Permission
            if (includePerm.checked) {
                out += `${indent}permission: ${name}.give\n`;
                out += `${indent}permission message: ${errorMsg.value}\n`;
            }

            // Cooldown
            if (cooldown.value && parseInt(cooldown.value) > 0) {
                out += `${indent}cooldown: ${cooldown.value} seconds\n`;
                out += `${indent}cooldown message: &cPlease wait %remaining time% before using this again!\n`;
            }

            out += `${indent}trigger:\n`;

            // Process commands
            let commandBlock = '';
            const loopTimes = loopCommands.checked ? parseInt(loopCount.value) || 1 : 1;

            for (let loop = 0; loop < loopTimes; loop++) {
                if (loopCommands.checked && commentEnabled) {
                    commandBlock += `${indent}${indent}# Loop iteration ${loop + 1}\n`;
                }

                lines.forEach((ln, i) => {
                    let processedLine = ln;

                    // Replace coordinates if enabled
                    if (replaceCoords.checked) {
                        processedLine = processedLine.replace(/~ ~ ~/g, '%player\'s location%');
                    }

                    // Add command comment
                    if (commentEnabled) {
                        if (descriptive) {

                            commandBlock += `${indent}${indent}# Command ${i + 1}\n`;
                        }
                    }

                    // Execute command
                    if (consoleExec.checked) {
                        commandBlock += `${indent}${indent}make console execute command "${processedLine.replace(/"/g, "'")}"\n`;
                    } else {
                        commandBlock += `${indent}${indent}execute console command "${processedLine.replace(/"/g, "'")}"\n`;
                    }

                    // Add delay
                    if (addDelay.checked && (i < lines.length - 1 || loop < loopTimes - 1)) {
                        const delay = parseFloat(delayTime.value) || 0.5;
                        commandBlock += `${indent}${indent}wait ${delay} seconds\n`;
                    }
                });
            }

            out += commandBlock;

            // Success message
            if (successMsg.value.trim()) {
                if (commentEnabled && descriptive) {
                    out += `${indent}${indent}# Send success notification\n`;
                }

                const msgType = messageType.value;
                if (msgType === 'send') {
                    out += `${indent}${indent}send "${successMsg.value}" to player\n`;
                } else if (msgType === 'actionbar') {
                    out += `${indent}${indent}send action bar "${successMsg.value}" to player\n`;
                } else if (msgType === 'title') {
                    out += `${indent}${indent}send title "${successMsg.value}" to player\n`;
                }
            }

            // Play sound
            if (playSound.checked && soundName.value.trim()) {
                if (commentEnabled && descriptive) {
                    out += `${indent}${indent}# Play success sound effect\n`;
                }
                out += `${indent}${indent}play sound "${soundName.value}" to player\n`;
            }

            return out;
        }

        function triggerUpdate() {
            try {
                const s = generateSkriptString();
                outputSkript.value = s || '## No valid input detected.';
                $('genStatus').textContent = s ? 'Preview updated' : '';
            } catch (e) {
                showAlert('Error: ' + e.message, 'error');
            }
        }

        // Events
        inputCommands.addEventListener('input', () => { updateCounts(); if (autoUpdate.checked) triggerUpdate(); });
        commandName.addEventListener('input', () => { if (autoUpdate.checked) triggerUpdate(); });
        aliases.addEventListener('input', () => { if (autoUpdate.checked) triggerUpdate(); });
        cooldown.addEventListener('change', () => { if (autoUpdate.checked) triggerUpdate(); });
        includePerm.addEventListener('change', () => { if (autoUpdate.checked) triggerUpdate(); });
        consoleExec.addEventListener('change', () => { if (autoUpdate.checked) triggerUpdate(); });
        addDelay.addEventListener('change', () => { if (autoUpdate.checked) triggerUpdate(); });
        delayTime.addEventListener('input', () => { if (autoUpdate.checked) triggerUpdate(); });
        loopCommands.addEventListener('change', () => { if (autoUpdate.checked) triggerUpdate(); });
        loopCount.addEventListener('input', () => { if (autoUpdate.checked) triggerUpdate(); });
        replaceCoords.addEventListener('change', () => { if (autoUpdate.checked) triggerUpdate(); });
        successMsg.addEventListener('input', () => { if (autoUpdate.checked) triggerUpdate(); });
        messageType.addEventListener('change', () => { if (autoUpdate.checked) triggerUpdate(); });
        playSound.addEventListener('change', () => { if (autoUpdate.checked) triggerUpdate(); });
        soundName.addEventListener('input', () => { if (autoUpdate.checked) triggerUpdate(); });
        errorMsg.addEventListener('input', () => { if (autoUpdate.checked) triggerUpdate(); });
        indentType.addEventListener('change', () => { if (autoUpdate.checked) triggerUpdate(); });
        commentStyle.addEventListener('change', () => { if (autoUpdate.checked) triggerUpdate(); });
        addHeader.addEventListener('change', () => { if (autoUpdate.checked) triggerUpdate(); });

        $('generateBtn').addEventListener('click', () => { triggerUpdate(); showAlert('Skript generated!', 'success'); });

        $('copyBtn').addEventListener('click', () => {
            navigator.clipboard.writeText(outputSkript.value);
            showAlert('Skript copied to clipboard!', 'success');
        });

        $('saveBtn').addEventListener('click', () => {
            const blob = new Blob([outputSkript.value], { type: 'text/plain' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = (commandName.value || 'mycommand') + '.sk';
            a.click();
            URL.revokeObjectURL(a.href);
            showAlert('File downloaded!', 'success');
        });

        $('zipBtn').addEventListener('click', async () => {
            if (typeof JSZip === 'undefined') {
                showAlert('JSZip library not loaded yet. Please try again.', 'error');
                return;
            }
            const zip = new JSZip();
            const fileName = (commandName.value || 'mycommand') + '.sk';
            zip.file(fileName, outputSkript.value);

            // Add a readme
            zip.file('README.txt', `Minecraft Skript Generator\n\nGenerated: ${new Date().toLocaleString()}\nCommand: /${commandName.value || 'mycommand'}\n\nInstallation:\n1. Place the .sk file in your server's plugins/Skript/scripts/ folder\n2. Run /sk reload ${fileName}\n3. Use the command in-game!\n`);

            const content = await zip.generateAsync({ type: 'blob' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(content);
            a.download = (commandName.value || 'mycommand') + '-skript.zip';
            a.click();
            URL.revokeObjectURL(a.href);
            showAlert('ZIP file downloaded!', 'success');
        });



        // Template system
        const templates = {
            armor: {
                name: 'armor',
                commands: `give @p minecraft:diamond_helmet{Enchantments:[{id:"protection",lvl:4}]}
give @p minecraft:diamond_chestplate{Enchantments:[{id:"protection",lvl:4}]}
give @p minecraft:diamond_leggings{Enchantments:[{id:"protection",lvl:4}]}
give @p minecraft:diamond_boots{Enchantments:[{id:"protection",lvl:4}]}`,
                message: '&aFull diamond armor set given!',
                sound: 'entity.player.levelup'
            },
            weapons: {
                name: 'weapons',
                commands: `give @p minecraft:diamond_sword{Enchantments:[{id:"sharpness",lvl:5},{id:"unbreaking",lvl:3}]}
give @p minecraft:bow{Enchantments:[{id:"power",lvl:5},{id:"infinity",lvl:1}]}
give @p minecraft:arrow 64`,
                message: '&aWeapons kit received!',
                sound: 'item.armor.equip_diamond'
            },
            items: {
                name: 'items',
                commands: `give @p minecraft:diamond 32
give @p minecraft:emerald 16
give @p minecraft:gold_ingot 64
give @p minecraft:ender_pearl 16`,
                message: '&aValuable items received!',
                sound: 'entity.item.pickup'
            },
            effects: {
                name: 'effects',
                commands: `effect give @p minecraft:speed 60 2
effect give @p minecraft:strength 60 2
effect give @p minecraft:jump_boost 60 2
effect give @p minecraft:regeneration 30 2`,
                message: '&aBuffs applied!',
                sound: 'entity.player.levelup'
            }
        };

        document.querySelectorAll('[data-tpl]').forEach(btn => {
            btn.addEventListener('click', () => {
                const type = btn.getAttribute('data-tpl');
                const template = templates[type];
                if (template) {
                    commandName.value = template.name;
                    inputCommands.value = template.commands;
                    successMsg.value = template.message;
                    soundName.value = template.sound;
                    playSound.checked = true;
                    triggerUpdate();
                    showAlert(`Template "${type}" loaded!`, 'success');
                }
            });
        });

        // Drag and drop file support
        const dropArea = $('dropArea');
        const importFile = $('importFile');

        dropArea.addEventListener('click', () => importFile.click());

        dropArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropArea.style.borderColor = '#667eea';
            dropArea.style.background = 'rgba(102, 126, 234, 0.05)';
        });

        dropArea.addEventListener('dragleave', () => {
            dropArea.style.borderColor = '';
            dropArea.style.background = '';
        });

        dropArea.addEventListener('drop', (e) => {
            e.preventDefault();
            dropArea.style.borderColor = '';
            dropArea.style.background = '';
            const file = e.dataTransfer.files[0];
            if (file) loadFile(file);
        });

        importFile.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) loadFile(file);
        });

        function loadFile(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                inputCommands.value = e.target.result;
                updateCounts();
                if (autoUpdate.checked) triggerUpdate();
                showAlert(`File "${file.name}" loaded successfully!`, 'success');
            };
            reader.onerror = () => {
                showAlert('Error reading file!', 'error');
            };
            reader.readAsText(file);
        }

        // Initialize
        updateCounts();
        triggerUpdate();
    </script>
</body>

</html>
